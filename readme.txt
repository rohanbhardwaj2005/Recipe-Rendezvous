Could not upload the whole code as it was too large. 
